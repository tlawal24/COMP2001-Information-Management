IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'CW2')
BEGIN
    EXEC('CREATE SCHEMA CW2');
END
GO

DROP TABLE IF EXISTS CW2.Profiles;
DROP TABLE IF EXISTS CW2.Reviews;

DROP TABLE IF EXISTS CW2.Role;
DROP TABLE IF EXISTS CW2.Trails;

DROP TABLE IF EXISTS CW2.Users;
GO


CREATE TABLE CW2.Users (
    USER_ID INT IDENTITY(1,1) PRIMARY KEY,
    USER_NAME VARCHAR(100) NOT NULL UNIQUE,
    Email VARCHAR(255) NOT NULL UNIQUE
);

CREATE TABLE CW2.Trails (
    TrailID INT IDENTITY(1,1) PRIMARY KEY,
    TrailName VARCHAR(150) NOT NULL,
    DESCRIPTION VARCHAR(500),
    Difficulty VARCHAR(50)
);

CREATE TABLE CW2.Reviews (
    ReviewID INT IDENTITY(1,1) PRIMARY KEY,
    USER_ID INT NOT NULL,
    TrailID INT NOT NULL,
    Rating INT CHECK (Rating BETWEEN 1 AND 5),
    Comment VARCHAR(500)
    FOREIGN KEY (USER_ID) REFERENCES CW2.Users(USER_ID),
    FOREIGN KEY (TrailID) REFERENCES CW2.Trails(TrailID)
);


CREATE TABLE CW2.Role (
    RoleID INT IDENTITY(1,1) PRIMARY KEY,
    RoleName VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE CW2.Profiles (
    ProfileID INT IDENTITY(1,1) PRIMARY KEY,
    USER_ID INT NOT NULL,
    Bio VARCHAR(500),
    FOREIGN KEY (USER_ID) REFERENCES CW2.Users(USER_ID)
);

SELECT TABLE_SCHEMA, TABLE_NAME
FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_SCHEMA = 'CW2';


SELECT TrailID FROM CW2.SavedTrails WHERE UserID = 1;
